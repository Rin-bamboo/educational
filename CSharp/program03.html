<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C#で始めるWindowsデスクトップアプリ開発：WPFとWinForms</title>
    <link rel="stylesheet" href="../css/style.css">

</head>
<body>
    <div class="container">
        <h1>C#で始めるWindowsデスクトップアプリ開発：WPFとWinForms</h1>
        <p>これまでの学習でC#の基本的なプログラミングスキルが身につきましたね。ここからは、皆さんが普段使っているような、ボタンやテキストボックスなどのグラフィカルな画面（GUI）を持つ<strong>Windowsデスクトップアプリケーション</strong>の作成方法について学びましょう。C#では主に<strong>Windows Forms (WinForms)</strong> と<strong>Windows Presentation Foundation (WPF)</strong> という2つの技術が使われます。</p>

        <section>
            <h2>1. Windowsデスクトップアプリとは？</h2>
            <p><strong>Windowsデスクトップアプリ</strong>は、Windowsオペレーティングシステム上で直接動作するアプリケーションのことです。Webブラウザやインターネット接続がなくても利用でき、OSの機能やローカルのファイルシステムに直接アクセスできるのが特徴です。</p>
            <h3>特徴</h3>
            <ul>
                <li><strong>GUI (Graphical User Interface):</strong> ボタン、テキストボックス、メニュー、画像などの視覚的な要素を使ってユーザーと対話します。</li>
                <li><strong>オフライン利用:</strong> インターネット接続がなくても動作します。</li>
                <li><strong>OSとの高い連携:</strong> ファイルシステム、レジストリ、周辺機器など、OSの機能に深くアクセスできます。</li>
                <li><strong>パフォーマンス:</strong> クライアントPCのリソースを直接利用するため、Webアプリに比べて高速な処理が可能です。</li>
            </ul>
        </section>

        <section>
            <h2>2. WinFormsとWPF：どちらを選ぶべきか？</h2>
            <p>C#でデスクトップアプリを開発する主要なフレームワークとして、WinFormsとWPFがあります。それぞれの特徴を理解し、適切な方を選びましょう。</p>

            <h3>2.1. Windows Forms (WinForms)</h3>
            <p><strong>WinForms</strong>は、最も古くからあるWindowsデスクトップアプリ開発のフレームワークです。Visual Studioのデザイナーでドラッグ＆ドロップにより直感的にGUIを構築でき、学習コストが低いのが特徴です。</p>
            <ul>
                <li><strong>登場時期:</strong> 2002年（.NET Framework 1.0と同時）</li>
                <li><strong>特徴:</strong>
                    <ul>
                        <li>デスクトップアプリ開発の<strong>基本的な知識を学ぶのに最適</strong>です。</li>
                        <li><strong>直感的でシンプルなGUI開発:</strong> Visual Studioのデザイナーでコントロールをドラッグ＆ドロップし、プロパティを設定するだけで簡単に画面を作成できます。</li>
                        <li><strong>イベント駆動型:</strong> ボタンクリックなどのユーザー操作に対して、対応するC#コードを記述します。</li>
                        <li><strong>古くからある技術:</strong> 多くの既存システムで利用されていますが、新しいプロジェクトではWPFや他のモダンな技術が選ばれることが多いです。</li>
                        <li><strong>.NET Framework専用:</strong> 基本的に.NET Framework上で動作します。</li>
                    </ul>
                </li>
            </ul>

            <h3>2.2. Windows Presentation Foundation (WPF)</h3>
            <p><strong>WPF</strong>は、WinFormsの後継として開発された、よりリッチで表現力豊かなUIを作成するためのフレームワークです。<strong>XAML（ザムル）</strong>というXMLベースの言語でUIを記述するのが特徴です。</p>
            <ul>
                <li><strong>登場時期:</strong> 2006年（.NET Framework 3.0と同時）</li>
                <li><strong>特徴:</strong>
                    <ul>
                        <li><strong>表現力豊かなUI:</strong> ベクターグラフィックス（拡大しても鮮明）、アニメーション、3D、動画など、より高度なグラフィックス表現が可能です。</li>
                        <li><strong>XAMLによるUI定義:</strong> UIのデザインとロジックを分離でき、デザイナーとプログラマーが分業しやすいです。</li>
                        <li><strong>データバインディングの強化:</strong> UIとC#のデータを効率的に同期させる強力な機能を持っています。</li>
                        <li><strong>MVVMパターンとの親和性:</strong> モダンな開発パターン（MVVM: Model-View-ViewModel）と非常に相性が良いです。</li>
                        <li><strong>.NET Framework/.NET (Core) 両対応:</strong> 比較的最近のプロジェクトで選択されることが多いです。</li>
                    </ul>
                </li>
            </ul>
            <div class="note">
                <p><strong>どちらを選ぶべきか？</strong></p>
                <ul>
                    <li><strong>初心者がデスクトップアプリ開発の基礎を学ぶなら、まずはWinFormsから始めるのがおすすめです。</strong> GUIの仕組みやイベント処理の概念を掴みやすいでしょう。</li>
                    <li><strong>よりモダンでリッチなUIを作成したい、または将来的に高度なアプリケーション開発を目指すなら、WPFに挑戦することをお勧めします。</strong> 学習コストは高めですが、その分できることも多く、市場のニーズも高いです。</li>
                </ul>
            </div>
        </section>

        <section>
            <h2>3. WinFormsアプリ開発の基本ステップ</h2>
            <p>ここでは、WinFormsを使って簡単なGUIアプリを作成する手順を見ていきましょう。</p>
            <h3>3.1. プロジェクトの作成</h3>
            <ol>
                <li>Visual Studioを開き、「新しいプロジェクトの作成」を選択します。</li>
                <li>検索ボックスに「Windowsフォーム アプリ (.NET Framework)」と入力し、C#言語のテンプレートを選択して「次へ」をクリックします。</li>
                <li>プロジェクト名（例: <code>MyWinFormsApp</code>）と場所を指定し、「作成」をクリックします。</li>
            </ol>
            <p>プロジェクトが作成されると、Visual Studioにデザイナ画面が表示され、フォーム（ウィンドウ）が１つ表示されます。</p>

            <h3>3.2. コントロールの配置とイベント処理</h3>
            <p>簡単なメッセージ表示アプリを作成してみましょう。</p>
            <ol>
                <li><strong>コントロールの配置:</strong>
                    <ul>
                        <li>Visual Studioの左側にある「ツールボックス」を開きます。</li>
                        <li>「Common Controls」カテゴリから以下のコントロールをフォームにドラッグ＆ドロップします。
                            <ul>
                                <li><code>TextBox</code>: ユーザーが文字を入力する部分</li>
                                <li><code>Button</code>: クリックできるボタン</li>
                                <li><code>Label</code>: テキストを表示する部分</li>
                            </ul>
                        </li>
                        <li>配置後、各コントロールを選択し、右下にある「プロパティ」ウィンドウで名前やテキストなどを設定します。
                            <ul>
                                <li><code>TextBox1</code>の<code>Name</code>を<code>textBoxName</code>に、<code>Text</code>を空に。</li>
                                <li><code>Button1</code>の<code>Name</code>を<code>buttonGreet</code>に、<code>Text</code>を<code>「挨拶」</code>に。</li>
                                <li><code>Label1</code>の<code>Name</code>を<code>labelMessage</code>に、<code>Text</code>を空に。</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><strong>イベントハンドラの記述:</strong>
                    <ul>
                        <li>フォームのデザイン画面で、配置した「挨拶」ボタン (<code>buttonGreet</code>) をダブルクリックします。</li>
                        <li>これにより、コードエディタが開き、ボタンがクリックされたときに実行されるメソッド (<strong>イベントハンドラ</strong>) が自動的に生成されます。</li>
                        <pre><code class="language-csharp">// Form1.cs (一部抜粋)
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void buttonGreet_Click(object sender, EventArgs e)
    {
        // ここにボタンがクリックされた時の処理を書く
        string name = textBoxName.Text; // textBoxNameに入力されたテキストを取得

        if (string.IsNullOrEmpty(name))
        {
            labelMessage.Text = "名前を入力してください！";
        }
        else
        {
            labelMessage.Text = $"こんにちは、{name}さん！"; // labelMessageにテキストを設定
        }
    }
}
                        </code></pre>
                    </ul>
                </li>
            </ol>

            <h3>3.3. アプリケーションの実行</h3>
            <p>Visual Studioのツールバーにある「デバッグ開始」（緑色の再生ボタン）をクリックするか、<code>F5</code>キーを押すと、作成したアプリが実行されます。テキストボックスに名前を入力し、ボタンをクリックして動作を確認しましょう。</p>
        </section>

        <section>
            <h2>4. WPFアプリ開発の基本ステップ（概念とXAML）</h2>
            <p>WPFでは、UIの記述にXAMLを使います。WinFormsとは異なる考え方でUIを構築します。</p>
            <h3>4.1. プロジェクトの作成</h3>
            <ol>
                <li>Visual Studioを開き、「新しいプロジェクトの作成」を選択します。</li>
                <li>検索ボックスに「WPF アプリケーション (.NET)」または「WPF アプリ (.NET Framework)」と入力し、C#言語のテンプレートを選択して「次へ」をクリックします。</li>
                <li>プロジェクト名（例: <code>MyWPFApp</code>）と場所を指定し、「作成」をクリックします。</li>
            </ol>
            <p>プロジェクトが作成されると、<code>MainWindow.xaml</code>とそのコードビハインドファイル<code>MainWindow.xaml.cs</code>が生成されます。<code>.xaml</code>ファイルには、UIのレイアウトやコントロールを記述します。</p>

            <h3>4.2. XAMLによるUI定義</h3>
            <p>XAMLはXMLベースのマークアップ言語です。UI要素をタグで記述し、見た目を定義します。</p>
            <pre><code class="language-xaml">&lt;Window x:Class="MyWPFApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="はじめてのWPFアプリ" Height="200" Width="300"&gt;
    &lt;Grid Margin="10"&gt;
        &lt;Grid.RowDefinitions&gt;
            &lt;RowDefinition Height="Auto"/&gt;
            &lt;RowDefinition Height="Auto"/&gt;
            &lt;RowDefinition Height="*"/&gt;
        &lt;/Grid.RowDefinitions&gt;
        &lt;Grid.ColumnDefinitions&gt;
            &lt;ColumnDefinition Width="Auto"/&gt;
            &lt;ColumnDefinition Width="*"/&gt;
        &lt;/Grid.ColumnDefinitions&gt;

        &lt;Label Grid.Row="0" Grid.Column="0" Content="あなたの名前:" VerticalAlignment="Center"/&gt;
        &lt;TextBox x:Name="textBoxName" Grid.Row="0" Grid.Column="1" Margin="5" /&gt;

        &lt;Button Grid.Row="1" Grid.ColumnSpan="2" Content="挨拶" Margin="5" Click="Button_Click"/&gt;
        
        &lt;Label x:Name="labelMessage" Grid.Row="2" Grid.ColumnSpan="2" Content="" VerticalAlignment="Center" HorizontalAlignment="Center"/&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
            </code></pre>
            <ul>
                <li><strong><code>&lt;Window&gt;</code>:</strong> アプリケーションのメインウィンドウを表します。</li>
                <li><strong><code>&lt;Grid&gt;</code>:</strong> レイアウトコントロールの一つで、行と列を定義してコントロールを配置できます。</li>
                <li><strong><code>x:Name="textBoxName"</code>:</strong> コードビハインドからコントロールを参照するための名前です。WinFormsの<code>Name</code>プロパティに相当します。</li>
                <li><strong><code>Content="..."</code>:</strong> ボタンやラベルに表示するテキストを設定します。</li>
                <li><strong><code>Click="Button_Click"</code>:</strong> ボタンがクリックされたときに実行するイベントハンドラを、コードビハインドで定義するメソッド名に指定します。</li>
            </ul>

            <h3>4.3. コードビハインドの記述</h3>
            <p>XAMLで定義したUIの背後で動作するC#コードです。</p>
            <pre><code class="language-csharp">// MainWindow.xaml.cs (一部抜粋)
using System.Windows; // MessageBoxなどを使うために必要

public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent(); // XAMLで定義されたUIを初期化
    }

    // XAMLで指定したイベントハンドラ
    private void Button_Click(object sender, RoutedEventArgs e)
    {
        string name = textBoxName.Text; // x:Nameで指定したコントロールを直接参照

        if (string.IsNullOrEmpty(name))
        {
            labelMessage.Content = "名前を入力してください！"; // LabelのContentプロパティ
        }
        else
        {
            labelMessage.Content = $"こんにちは、{name}さん！";
        }
    }
}
            </code></pre>
            <div class="note">
                <p>WPFでは、WinFormsとは異なり、<code>Text</code>プロパティではなく<code>Content</code>プロパティでテキストを設定することが多いです（コントロールの種類によって異なります）。</p>
            </div>

            <h3>4.4. データバインディング（WPFの強力な機能）</h3>
            <p>WPFの大きな特徴の一つが強力なデータバインディングです。これにより、UIとC#のデータを自動的に同期させることができます。</p>
            <pre><code class="language-xaml">&lt;!-- MainWindow.xaml --&gt;
&lt;Grid Margin="10"&gt;
    &lt;TextBox Text="{Binding UserName, Mode=TwoWay}" Width="150" Height="30"/&gt;
    &lt;TextBlock Text="{Binding UserName}" Margin="0,40,0,0"/&gt;
&lt;/Grid&gt;
            </code></pre>
            <pre><code class="language-csharp">// MainWindow.xaml.cs (例: ViewModelと連携)
using System.ComponentModel; // INotifyPropertyChangedを使うために必要

public partial class MainWindow : Window, INotifyPropertyChanged
{
    private string _userName;
    public string UserName
    {
        get { return _userName; }
        set
        {
            if (_userName != value)
            {
                _userName = value;
                OnPropertyChanged("UserName"); // プロパティが変更されたことをUIに通知
            }
        }
    }

    public MainWindow()
    {
        InitializeComponent();
        this.DataContext = this; // このウィンドウ自身をデータコンテキストとして設定
        UserName = "ゲスト"; // 初期値
    }

    // INotifyPropertyChangedインターフェースの実装
    public event PropertyChangedEventHandler PropertyChanged;
    protected void OnPropertyChanged(string propertyName)
    {
        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }
}
            </code></pre>
            <p><code>Text="{Binding UserName, Mode=TwoWay}"</code> のように記述するだけで、TextBoxの値とC#コードの<code>UserName</code>プロパティが双方向に自動で同期されます。この機能は、複雑なUIを持つアプリケーション開発において非常に強力です。</p>
        </section>

        <section>
            <h2>5. 次のステップへ</h2>
            <p>WinFormsとWPFの基本的な違いと、簡単なアプリケーションの作成方法を学びました。どちらの技術も奥が深く、さらに学ぶべきことがたくさんあります。</p>
            <ul>
                <li><strong>WinForms:</strong> より多くのコントロール（DataGridView, TreeViewなど）の使い方、データベース連携、MDI（複数ドキュメントインターフェース）などを学びましょう。</li>
                <li><strong>WPF:</strong> レイアウトパネル（StackPanel, DockPanelなど）、スタイル、テンプレート、カスタムコントロール、MVVMパターンなどを深く掘り下げましょう。</li>
                <li><strong>共通:</strong> アプリケーションのデプロイ（配布）、エラーハンドリング、非同期処理、パフォーマンス最適化など、実用的なアプリ開発に必要なスキルを磨きましょう。</li>
            </ul>
            <div class="note">
                <p>デスクトップアプリ開発は、ユーザーに直接触れるインターフェースを作る楽しさがあります。ぜひ色々なアイデアを形にしてみてください。</p>
            </div>
        </section>

        <section>
            <h2>参考資料</h2>
            <ul>
                <li><a href="https://learn.microsoft.com/ja-jp/dotnet/desktop/winforms/" target="_blank">Microsoft Learn: Windows フォーム (WinForms) の概要</a></li>
                <li><a href="https://learn.microsoft.com/ja-jp/dotnet/desktop/wpf/" target="_blank">Microsoft Learn: WPF (Windows Presentation Foundation) の概要</a></li>
                <li>Visual Studio ドキュメント</li>
                <li>C#によるデスクトップアプリ開発に関する書籍やオンラインチュートリアル</li>
            </ul>
        </section>

        <div class="call-to-action">
            <a href="../index.html">目次へ戻る</a>
        </div>
        
        <footer>
            <p style="text-align: center; font-size: 0.85em; color: #6c757d; margin-top: 40px; padding-top: 15px; border-top: 1px solid #e9ecef;">
                作成日: 2025年6月12日
            </p>
        </footer>
    </div>
</body>
</html>